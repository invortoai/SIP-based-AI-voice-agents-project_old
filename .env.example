# Environment Configuration for Invorto Voice AI Platform

# Node Environment
NODE_ENV=development

# Database Configuration
DB_URL=postgresql://user:password@localhost:5432/invorto
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_KEY=your-service-key

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_CLUSTER_MODE=false

# AWS Configuration
AWS_REGION=ap-south-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key

# S3 Buckets
S3_BUCKET_RECORDINGS=invorto-recordings
S3_BUCKET_TRANSCRIPTS=invorto-transcripts
S3_BUCKET_METRICS=invorto-metrics

# Deepgram Configuration
DEEPGRAM_API_KEY=your-deepgram-api-key
DEEPGRAM_MODEL=nova-2
DEEPGRAM_LANGUAGE=en-US

# OpenAI Configuration
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-4o-mini
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=1000

# JWT Configuration
JWT_SECRET=your-jwt-secret-key
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
-----END PUBLIC KEY-----"
JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...
-----END PRIVATE KEY-----"
JWT_EXPIRY=7d

# Webhook Configuration
WEBHOOK_SECRET=your-webhook-secret
TENANT_WEBHOOK_URL=https://customer.example.com/webhook
MAX_WEBHOOK_RETRIES=3
WEBHOOK_TIMEOUT=10000
DLQ_TTL_DAYS=7

# Service Ports
API_PORT=8080
REALTIME_PORT=8081
WEBHOOKS_PORT=8082
WORKERS_PORT=8083

# Rate Limiting
MAX_CONCURRENT_CALLS=10
DAILY_COST_CAP_INR=10000
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Consent & Prompts
CONSENT_PROMPT="This call may be recorded for quality and training purposes. Do I have your consent to proceed?"
SYSTEM_PROMPT="You are a helpful AI voice assistant."

# Logging & Monitoring
LOG_LEVEL=info
ENABLE_METRICS=true
METRICS_PORT=9090
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=invorto-voice-platform
LANGFUSE_PUBLIC_KEY=your-langfuse-public-key
LANGFUSE_SECRET_KEY=your-langfuse-secret-key
LANGFUSE_HOST=https://cloud.langfuse.com

# Feature Flags
ENABLE_TOOL_CALLING=true
ENABLE_EMOTION_DETECTION=false
ENABLE_SPEAKER_DIARIZATION=false
ENABLE_PROFANITY_FILTER=false
ENABLE_PII_REDACTION=true

# Performance Tuning
JITTER_BUFFER_TARGET_MS=40
ENDPOINTING_SILENCE_MS=220
ENDPOINTING_MIN_WORDS=2
TTS_PREWARM=true
ASR_UTTERANCE_END_MS=1000

# Public Endpoints (Single domain)
PUBLIC_BASE_URL=https://api.invortoai.com
API_BASE_URL=https://api.invortoai.com/v1
REALTIME_WS_URL=wss://api.invortoai.com/realtime/voice
WEBHOOK_BASE_URL=https://api.invortoai.com/webhooks
TELEPHONY_WEBHOOK_BASE_URL=https://api.invortoai.com/telephony

# Realtime WS Authentication & Limits
# Prefer API key via WS subprotocol; JWT bearer supported; optional HMAC (sig, ts) using REALTIME_WS_SECRET
REALTIME_API_KEY=your-realtime-api-key
REALTIME_WS_SECRET=your-realtime-ws-hmac-secret
REALTIME_ALLOW_MULTI=0
MAX_CONNECTIONS_PER_CALL=1
CONNECTION_TIMEOUT=300000
MESSAGE_RATE_LIMIT=100

# Realtime Emotion/Endpointing (optional)
EMOTION_THRESHOLD_DB=-50
EMOTION_WINDOW_MS=250
EMOTION_MIN_HOLD=2
EMOTION_STATE_ENABLED=false

# Jambonz Integration
JAMBONZ_WEBHOOK_SECRET=your-jambonz-webhook-secret
JAMBONZ_ACCOUNT_SID=your-jambonz-account-sid
JAMBONZ_APPLICATION_SID=your-jambonz-application-sid
ALLOWED_JAMBONZ_IPS=
TELEPHONY_SHARED_SECRET=
# Outbound origination support from API â†’ Jambonz (optional)
JAMBONZ_OUTCALL_URL=
JAMBONZ_TOKEN=
JAMBONZ_APP_SID=
# Telephony service call hook base (used by API to instruct jambonz)
TELEPHONY_CALL_HOOK=http://telephony:8085/call

# Concurrency Limits (Redis-backed)
TELEPHONY_PER_CAMPAIGN_MAX_CONCURRENCY=20
TELEPHONY_GLOBAL_MAX_CONCURRENCY=100
TELEPHONY_SEMAPHORE_TTL_SEC=3600

# Security
ALLOWED_ORIGINS=http://localhost:3000,https://app.invorto.ai
API_KEY_HEADER=x-api-key
TENANT_ID_HEADER=x-tenant-id
ENABLE_CORS=true
CORS_CREDENTIALS=true

# External Services
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# Development
DEBUG=false
PRETTY_LOGS=true
MOCK_EXTERNAL_SERVICES=false